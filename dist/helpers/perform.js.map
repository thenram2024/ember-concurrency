{"version":3,"file":"perform.js","sources":["../../src/helpers/perform.ts"],"sourcesContent":["import { helper } from '@ember/component/helper';\nimport { assert } from '@ember/debug';\nimport { taskHelperClosure } from '../-private/helpers';\nimport type { Task } from '../index';\n\nfunction maybeReportError(\n  onError: (error: unknown) => void | null | undefined,\n) {\n  return function (e: unknown) {\n    if (typeof onError === 'function') {\n      onError(e);\n    } else if (onError === null) {\n      // Do nothing\n    } else {\n      assert(\n        `The onError argument passed to the \\`perform\\` helper should be a function or null; you passed ${onError}`,\n        false,\n      );\n    }\n  };\n}\n\ntype PerformParams = [task: Task<any, any[]>, ...args: any[]];\n\nexport function performHelper(args: PerformParams, hash: any) {\n  let perform = taskHelperClosure('perform', 'perform', args, hash);\n\n  if (hash && typeof hash.onError !== 'undefined') {\n    return function (...innerArgs: any[]) {\n      try {\n        let taskInstance = perform(...innerArgs);\n        return taskInstance.catch(maybeReportError(hash.onError));\n        // eslint-disable-next-line no-empty\n      } catch {\n        maybeReportError(hash.onError);\n      }\n    };\n  } else {\n    return perform;\n  }\n}\n\nexport default helper(performHelper);\n"],"names":["maybeReportError","onError","e","assert","performHelper","args","hash","perform","taskHelperClosure","innerArgs","taskInstance","catch","helper"],"mappings":";;;;AAKA,SAASA,gBAAgBA,CACvBC,OAAoD,EACpD;EACA,OAAO,UAAUC,CAAU,EAAE;AAC3B,IAAA,IAAI,OAAOD,OAAO,KAAK,UAAU,EAAE;MACjCA,OAAO,CAACC,CAAC,CAAC,CAAA;AACZ,KAAC,MAAM,IAAID,OAAO,KAAK,IAAI,EAAE,CAE5B,MAAM;AACLE,MAAAA,MAAM,CACH,CAAiGF,+FAAAA,EAAAA,OAAQ,CAAC,CAAA,EAC3G,KACF,CAAC,CAAA;AACH,KAAA;GACD,CAAA;AACH,CAAA;AAIO,SAASG,aAAaA,CAACC,IAAmB,EAAEC,IAAS,EAAE;EAC5D,IAAIC,OAAO,GAAGC,iBAAiB,CAAC,SAAS,EAAE,SAAS,EAAEH,IAAI,EAAEC,IAAI,CAAC,CAAA;EAEjE,IAAIA,IAAI,IAAI,OAAOA,IAAI,CAACL,OAAO,KAAK,WAAW,EAAE;IAC/C,OAAO,UAAU,GAAGQ,SAAgB,EAAE;MACpC,IAAI;AACF,QAAA,IAAIC,YAAY,GAAGH,OAAO,CAAC,GAAGE,SAAS,CAAC,CAAA;QACxC,OAAOC,YAAY,CAACC,KAAK,CAACX,gBAAgB,CAACM,IAAI,CAACL,OAAO,CAAC,CAAC,CAAA;AACzD;AACF,OAAC,CAAC,MAAM;AACND,QAAAA,gBAAgB,CAACM,IAAI,CAACL,OAAO,CAAC,CAAA;AAChC,OAAA;KACD,CAAA;AACH,GAAC,MAAM;AACL,IAAA,OAAOM,OAAO,CAAA;AAChB,GAAA;AACF,CAAA;AAEA,cAAeK,MAAM,CAACR,aAAa,CAAC;;;;"}